<p>Объектная модель движка представлена на рисунке:</p>
<center><img src="eom.png"></center>
<p>В движке ресурсы данных различных типов, таких как <i>объекты</i>,
<i>материалы</i>, <i>текстуры</i>, <i>шейдеры</i>, могут быть доступны
посредством обращения к ним, с использованием <i>иерархического имени</i>,
первой частью которого является тип требуемых данных. При этом
загрузка осуществляется автоматически вне зависимости от количества
уровней иерархии запрошенных ресурсов данных.</p>
<h3>Локации и области</h3>
<p>Как видим, мир состоит из локаций (больших подпространств), каждая
локация может быть связана с другими локациями, но не может быть
вложенных и пересекающихся локаций. Обычно локации имеют равный
размер, в общих чертах на макроскопическом уровне могут быть
представлены ограничивающими их боксами. Каждая локация содержит в
себе большие объекты, ограничивающие ее. Одновременно могут быть
загружены от одной до нескольких локаций, и они не обязательно должны
быть напрямую связаны друг с другом. Это обеспечивает возможность
одновременной обработки нескольких локаций в мире.</p>
<p>Внутри локаций располагаются объекты окружения, ограничивающие
собой локацию. Объекты окружения могут содержать в себе области (малые
подпросранства). В каждой области могут располагаться другие объекты,
которые также могут иметь вложенные области, которые также могут
содержать в себе объекты и так далее. Каждая область, как правило,
имеет статические объекты, то есть те, которые изначально и навсегда
привязаны к данной области. А также, в области могут располагаться
динамические объекты, которые присутствуют в ней наряду со
статическими, но могут быть перемещены в другие области или перемещены
из них. Следует обратить внимание, что в данном случае под статикой не
подразумевается поведение самого объекта, другими словами объект может
быть перемещаем, изменяем, но только в пределах данной области. Это
положение гарантирует корректную обработку с минимальной затратой
вычислительных мощностей. Локация тоже представляет из себя
своеобразную область, только более высокого уровня.</p>
<p>Такое разбиение мира на локации и области значительно упрощает
работу с большим числом объектов, позволяя не только определять
актуальные по области видимости объекты, но и динамически менять
уровни детализации, а также в широких пределах управлять точностью
обработки мира, оптимизируя тем самым работу движка с точки зрения
используемых системных ресурсов.</p>
<h3>Подробнее об областях</h3>
<p>Система разбиения локации на области преследует следующие цели:
<ol>
  <li>оптимизация рендеринга;</li>
  <li>оптимизация физической симуляции;</li>
  <li>упрощение представления мира;</li>
  <li>упрощение состояния мира для хранения;</li>
</ol></p>
<p>В достижении этих целей система областей осуществляет следующее:
<ol>
  <li>предварительное определение областей с учетом уровней их
  вложенности;</li>
  <li>предварительное размещение объектов проделывается единожды при
  проектировании;</li>
  <li>четкое разделение объектов на статические и динамические,
  с целью отслеживания перемещений между областями только статических
  объектов;</li>
  <li>постое быстрое отслеживание перемещения динамических объектов
  между областями на основе анализа пересечения ими границ
  областей;</li>
  <li>простая и быстрая обработка перемещения динамических областей
  аналогично тому, как перемещаются динамические объекты, содержащие
  эти области;</li>
</ol></p>
<p>Первые две операции требуют больших вычислительных затрат, чем
последующее отслеживание состояния.</p>
<p>Области могут быть сколь угодно вложенными, при этом одна дочерняя
(вложенная) область может находиться в нескольких
родительских. Области одного уровня не должны пересекаться объемно, то
есть они могут пересекаться только в зоне так называемой границы,
представляющей из себя ограниченную плоскую геометрию (это обычно
бывает портал, разделяющий сектора).</p>
<p>Далее приводим примеры обработки расположения объектов с краткими
пояснениями.</p>
<img src=area1.png class=docum><p>На рисунке I представлен случай,
когда один объект (1) находится строго в одной области (A), а другой
(2) одновременно в двух областях одного уровня вложенности (A,B). На
рисунке II изображены области одного уровня области (A и B) и область
(C) следующего после них уровня вложенности (дочерняя область по
отношению к ним). При этом один объект (1) расположен во вложенной
области (C) (!НЕ в A), другой объект (2) одновременно располагается в
двух областях (C и B) (!НЕ в A), третий (3) также находится в двух
областях (A и C). В случае объекта (2) имеет место пересечение им
границы между областями A и B, но будучи размещенным в области C,
которая является вложенной по отношению к A и B, он тяготеет к ней, а
так как он пересекает границу между областями C и A, то он может
находиться также в области A.</p>
<p>Такое соотнесение объектов с областями обусловленно алгоритмом
анализа, который будет изложен ниже.</p>
<h3>Событийная модель</h3>
<p>С объектной моделью очень тесно связана событийная модель
движка. Все процессы сопровождаются возникновением событий, которые
свидетельствуют о необходимости выполнения каких-либо действий. Все
события делятся на два основных класса:</p>
<ol>
  <li><u>События объектного типа</u> - те, чье возникновение
  свидетельствует об изменении объектной структуры;</li>
  <li><u>События процессного типа</u> - те, которые возникают в процессе
  обработки объектов мира или при изменении параметров самих
  объектов.</li>
</ol>
<p>Первый класс событий носит глобальный характер, их обрабатывают
такие объекты, как Render и Physics, а также возможно и другие. Второй
класс служит для выполнения специфицируемых пользователем действий,
связанных с процессами, протекающими при работе движка.</p>
<p>Характерна также та особенность, что события первого класса
возникают и обрабатываются на внутреннем уровне, в то время, как
события второго класса зачастую обрабатываются скриптами.</p>
<p class=post><!-- hhmts start -->Last modified: Sun Apr 29 12:04:45 YEKST 2007 <!-- hhmts end --></p>
